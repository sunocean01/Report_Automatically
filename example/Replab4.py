#!/usr/bin/env python3# -*- coding: utf-8 -*-from reportlab.platypus import SimpleDocTemplate, Paragraphfrom reportlab.platypus import PageBreakfrom reportlab.lib.styles import ParagraphStylefrom reportlab.lib.colors import Colorfrom reportlab.lib.pagesizes import A4from reportlab.lib.units import mmfrom reportlab.pdfbase import pdfmetricsfrom reportlab.pdfbase.ttfonts import TTFontfrom reportlab.graphics.barcode import qr#首页def myFirstPage(canvas, doc):    canvas.saveState()    canvas.setFillColorRGB(0, 0, 0)    canvas.setFont('微软雅黑',12)    str="（内部资料）"    canvas.drawCentredString(doc.width/2, 25*mm, str)    myLaterPages(canvas, doc)    canvas.restoreState()    #页眉页脚def myLaterPages(canvas, doc):    canvas.saveState()    canvas.setStrokeColorRGB(0.8, 0.8, 0.8)    canvas.line(0, 32, doc.width, 32)    canvas.line(0, A4[1]-45, doc.width, A4[1]-45)    canvas.setFillColorRGB(0, 0, 0)    canvas.setFont('微软雅黑',10)    str=f"Page {doc.page}"    canvas.drawCentredString(doc.width/2, 5*mm, str)    canvas.setFillColorRGB(1, 0, 0)    canvas.drawCentredString(doc.width/2, A4[1]-9*mm, "XX有限公司版权所有")    qr_code = qr.QrCode('https://www.cnblogs.com/windfic', width=45, height=45)    canvas.setFillColorRGB(0, 0, 0)    qr_code.drawOn(canvas, 0, A4[1]-45)    canvas.restoreState()def main(filename):    pdfmetrics.registerFont(TTFont('微软雅黑', 'msyh.ttf'))        doc = SimpleDocTemplate(filename, pagesize=A4, leftMargin=10, rightMargin=10)        title = ParagraphStyle(name = 'Title',        fontName = '微软雅黑',        fontSize = 22,        leading = 16,        alignment = 1,        spaceAfter = 20)    contents = []    contents.append(Paragraph('使用SimpleDocTemplate', title))    contents.append(Paragraph('Hello'))    contents.append(PageBreak())    contents.append(Paragraph('World'))        doc.build(contents, onFirstPage=myFirstPage, onLaterPages=myLaterPages)if __name__ == '__main__':    main("Replab4.pdf")    